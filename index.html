<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1"/>
  <title>Nitya Seva ‚Äî ISKCON Centre Orai</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <script src="https://www.paynimo.com/paynimocheckout/client/lib/jquery.min.js"></script>
  <script src="https://www.paynimo.com/paynimocheckout/server/lib/checkout.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --saffron:#E8762B; --saffron-d:#C4581A; --saffron-l:#FDF0E6;
      --gold:#C9922A; --gold-l:#FBF3E0;
      --cream:#FDFAF4; --ink:#1C1608; --muted:#7A6A50;
      --border:#E8DFC8; --white:#FFFFFF;
      --green:#2D6A3F; --green-l:#E8F5ED;
      --r:12px; --shadow:0 8px 40px rgba(28,22,8,0.10);
    }
    body {
      font-family:'Jost',sans-serif; background:var(--cream); color:var(--ink);
      min-height:100vh; display:flex; flex-direction:column;
      align-items:center; padding:0 16px 80px; overflow-x:hidden;
    }
    .top-band {
      width:100%; background:linear-gradient(135deg,#1C1608 0%,#3A2A08 50%,#1C1608 100%);
      padding:10px 24px; display:flex; align-items:center;
      justify-content:center; gap:10px; margin-bottom:0;
    }
    .top-band span { color:var(--gold); font-size:11px; font-weight:500; letter-spacing:2px; text-transform:uppercase; }
    .lotus { font-size:15px; }
    .hero { text-align:center; padding:40px 20px 30px; max-width:520px; animation:fadeUp .7s ease both; }
    .emblem { width:76px; height:76px; margin:0 auto 18px; }
    .emblem svg { width:100%; height:100%; }
    .org-name { font-family:'Cormorant Garamond',serif; font-size:12px; font-weight:600; letter-spacing:3px; text-transform:uppercase; color:var(--gold); margin-bottom:10px; }
    .hero h1 { font-family:'Cormorant Garamond',serif; font-size:clamp(34px,6vw,52px); font-weight:400; line-height:1.1; color:var(--ink); margin-bottom:12px; }
    .hero h1 em { color:var(--saffron); font-style:italic; }
    .hero p { font-size:14px; color:var(--muted); line-height:1.7; max-width:360px; margin:0 auto; font-weight:300; }
    .ornament { display:flex; align-items:center; gap:12px; color:var(--gold); font-size:17px; margin:8px auto 28px; width:fit-content; }
    .ornament::before,.ornament::after { content:''; display:block; width:55px; height:1px; }
    .ornament::before { background:linear-gradient(to right,transparent,var(--gold)); }
    .ornament::after  { background:linear-gradient(to left,transparent,var(--gold)); }
    .steps { display:flex; align-items:center; gap:0; margin-bottom:24px; animation:fadeUp .7s .1s ease both; opacity:0; animation-fill-mode:both; }
    .step-item { display:flex; flex-direction:column; align-items:center; gap:5px; }
    .step-dot { width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px; font-weight:600; background:var(--border); color:var(--muted); transition:all .3s ease; border:2px solid transparent; }
    .step-dot.active { background:var(--saffron); color:white; border-color:var(--saffron-d); box-shadow:0 0 0 4px rgba(232,118,43,0.18); }
    .step-dot.done { background:var(--green); color:white; border-color:var(--green); }
    .step-label { font-size:9px; font-weight:600; letter-spacing:.8px; text-transform:uppercase; color:var(--muted); transition:color .3s; }
    .step-label.active { color:var(--saffron); }
    .step-conn { width:44px; height:1.5px; background:var(--border); margin:0 4px 20px; transition:background .4s; }
    .step-conn.done { background:var(--green); }
    .card { background:var(--white); border-radius:var(--r); box-shadow:var(--shadow); border:1px solid var(--border); padding:36px 30px; width:100%; max-width:480px; animation:fadeUp .7s .15s ease both; opacity:0; animation-fill-mode:both; }
    .card-eyebrow { font-size:10px; font-weight:600; letter-spacing:2px; text-transform:uppercase; color:var(--saffron); margin-bottom:5px; }
    .card-title { font-family:'Cormorant Garamond',serif; font-size:25px; font-weight:600; color:var(--ink); margin-bottom:4px; }
    .card-sub { font-size:13px; color:var(--muted); margin-bottom:26px; line-height:1.6; font-weight:300; }
    .form-group { margin-bottom:16px; }
    .form-group label { display:block; font-size:11px; font-weight:600; letter-spacing:.8px; text-transform:uppercase; color:var(--muted); margin-bottom:6px; }
    .form-group input,.form-group select {
      width:100%; padding:12px 14px; border:1.5px solid var(--border); border-radius:8px;
      font-family:'Jost',sans-serif; font-size:15px; color:var(--ink);
      background:var(--cream); transition:border-color .2s,box-shadow .2s,background .2s;
      outline:none; appearance:none; -webkit-appearance:none;
    }
    .form-group input:focus,.form-group select:focus { border-color:var(--saffron); background:var(--white); box-shadow:0 0 0 3px rgba(232,118,43,0.12); }
    .form-group input.err { border-color:#c0392b; }
    .ferr { font-size:11px; color:#c0392b; margin-top:4px; display:none; }
    .ferr.show { display:block; }
    .ph-wrap { display:flex; border:1.5px solid var(--border); border-radius:8px; overflow:hidden; background:var(--cream); transition:border-color .2s,box-shadow .2s; }
    .ph-wrap:focus-within { border-color:var(--saffron); background:var(--white); box-shadow:0 0 0 3px rgba(232,118,43,0.12); }
    .ph-wrap.err { border-color:#c0392b; }
    .ph-pfx { display:flex; align-items:center; gap:5px; padding:12px 13px; background:var(--gold-l); border-right:1.5px solid var(--border); font-size:14px; color:var(--muted); font-weight:500; white-space:nowrap; flex-shrink:0; }
    .ph-wrap input { border:none!important; box-shadow:none!important; border-radius:0!important; background:transparent!important; flex:1; }
    .amount-presets { display:flex; flex-wrap:wrap; gap:7px; margin-bottom:9px; }
    .preset-btn { padding:6px 13px; border:1.5px solid var(--border); border-radius:100px; font-family:'Jost',sans-serif; font-size:13px; font-weight:500; color:var(--muted); background:var(--cream); cursor:pointer; transition:all .2s; }
    .preset-btn:hover { border-color:var(--saffron); color:var(--saffron); }
    .preset-btn.sel { background:var(--saffron); color:white; border-color:var(--saffron-d); }
    .row2 { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .info-box { background:var(--gold-l); border:1px solid #E8D5A0; border-radius:8px; padding:11px 14px; font-size:12px; color:#7A5C20; line-height:1.6; margin-bottom:20px; display:flex; gap:8px; align-items:flex-start; }
    .summary-box { background:var(--cream); border:1.5px solid var(--border); border-radius:10px; padding:16px 18px; margin-bottom:20px; }
    .summary-title { font-size:10px; font-weight:600; letter-spacing:1.5px; text-transform:uppercase; color:var(--gold); margin-bottom:12px; }
    .sum-row { display:flex; justify-content:space-between; font-size:13px; padding:6px 0; border-bottom:1px solid var(--border); }
    .sum-row:last-child { border-bottom:none; }
    .sum-row .k { color:var(--muted); font-weight:300; }
    .sum-row .v { font-weight:500; text-align:right; max-width:60%; }
    .btn { display:flex; align-items:center; justify-content:center; gap:8px; width:100%; padding:14px 22px; border:none; border-radius:8px; font-family:'Jost',sans-serif; font-size:15px; font-weight:600; cursor:pointer; transition:all .2s ease; letter-spacing:.3px; }
    .btn-primary { background:linear-gradient(135deg,var(--saffron) 0%,var(--saffron-d) 100%); color:white; }
    .btn-primary:hover { transform:translateY(-2px); box-shadow:0 8px 24px rgba(232,118,43,0.35); }
    .btn-primary:active { transform:translateY(0); }
    .btn-primary:disabled { opacity:.6; cursor:not-allowed; transform:none; box-shadow:none; }
    .btn-ghost { background:transparent; color:var(--muted); border:1.5px solid var(--border); margin-top:10px; font-size:13px; }
    .btn-ghost:hover { border-color:var(--muted); color:var(--ink); }
    .spin { width:17px; height:17px; border:2px solid rgba(255,255,255,.4); border-top-color:white; border-radius:50%; animation:spinning .6s linear infinite; display:none; }
    .trust { display:flex; align-items:center; justify-content:center; gap:16px; flex-wrap:wrap; margin-top:18px; }
    .trust-item { display:flex; align-items:center; gap:5px; font-size:11px; color:var(--muted); font-weight:500; }
    .result { text-align:center; padding:8px 0 14px; }
    .result-icon { width:74px; height:74px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; animation:popIn .4s cubic-bezier(.34,1.56,.64,1) both; }
    .r-success { background:var(--green-l); }
    .r-pending { background:#FFF8E1; }
    .r-error   { background:#FDEDEB; }
    .result h2 { font-family:'Cormorant Garamond',serif; font-size:28px; font-weight:600; margin-bottom:10px; }
    .result p  { font-size:13px; color:var(--muted); line-height:1.7; font-weight:300; }
    .mandate-pill { display:inline-block; background:var(--saffron-l); color:var(--saffron-d); font-size:12px; font-weight:600; letter-spacing:1px; padding:6px 18px; border-radius:100px; margin:14px 0; }
    .checklist { background:var(--green-l); border-radius:10px; padding:14px 16px; margin:16px 0; text-align:left; }
    .check-item { display:flex; align-items:center; gap:9px; font-size:13px; color:var(--green); padding:4px 0; }
    .screen { display:none; }
    .screen.active { display:block; animation:fadeUp .35s ease both; }
    .footer { margin-top:24px; text-align:center; font-size:11px; color:var(--muted); animation:fadeUp .7s .3s ease both; opacity:0; animation-fill-mode:both; }
    .footer a { color:var(--saffron); text-decoration:none; }
    @keyframes fadeUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }
    @keyframes popIn  { from{opacity:0;transform:scale(.5)}       to{opacity:1;transform:scale(1)} }
    @keyframes spinning { to{transform:rotate(360deg)} }
    @media(max-width:480px){ .card{padding:24px 18px;} .row2{grid-template-columns:1fr;} .step-conn{width:26px;} }
  </style>
</head>
<body>

<div class="top-band">
  <span class="lotus">ü™∑</span>
  <span>Hare Krishna ¬∑ Hare Krishna ¬∑ Krishna Krishna ¬∑ Hare Hare</span>
  <span class="lotus">ü™∑</span>
</div>

<div class="hero">
  <div class="emblem">
    <svg viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="40" cy="40" r="38" stroke="#C9922A" stroke-width="1.5" stroke-dasharray="4 3"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85" transform="rotate(45 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85" transform="rotate(90 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85" transform="rotate(135 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(22.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(67.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(112.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(157.5 40 40)"/>
      <circle cx="40" cy="40" r="10" fill="#FBF3E0" stroke="#C9922A" stroke-width="1.5"/>
      <circle cx="40" cy="40" r="5" fill="#E8762B"/>
    </svg>
  </div>
  <div class="org-name">ISKCON Centre Orai</div>
  <h1>Nitya <em>Seva</em></h1>
  <p>Offer daily service to the Lord through automated giving ‚Äî sacred, secure &amp; uninterrupted.</p>
</div>

<div class="ornament">üå∏</div>

<div class="steps" id="stepIndicators">
  <div class="step-item"><div class="step-dot active" id="dot1">1</div><span class="step-label active" id="lbl1">You</span></div>
  <div class="step-conn" id="conn1"></div>
  <div class="step-item"><div class="step-dot" id="dot2">2</div><span class="step-label" id="lbl2">Seva</span></div>
  <div class="step-conn" id="conn2"></div>
  <div class="step-item"><div class="step-dot" id="dot3">3</div><span class="step-label" id="lbl3">Bank</span></div>
  <div class="step-conn" id="conn3"></div>
  <div class="step-item"><div class="step-dot" id="dot4">4</div><span class="step-label" id="lbl4">Done</span></div>
</div>

<div class="card">

  <!-- STEP 1 -->
  <div class="screen active" id="s1">
    <div class="card-eyebrow">Step 1 of 3</div>
    <div class="card-title">Your details</div>
    <div class="card-sub">Tell us who you are so we can register your seva correctly.</div>
    <div class="form-group">
      <label>Full Name</label>
      <input type="text" id="fname" placeholder="e.g. Rajesh Kumar" autocomplete="name"/>
      <div class="ferr" id="eName">Please enter your full name</div>
    </div>
    <div class="form-group">
      <label>Mobile Number</label>
      <div class="ph-wrap" id="phWrap">
        <div class="ph-pfx">üáÆüá≥ +91</div>
        <input type="tel" id="fmobile" placeholder="9876543210" maxlength="10" inputmode="numeric"/>
      </div>
      <div class="ferr" id="eMobile">Enter a valid 10-digit mobile number</div>
    </div>
    <div class="form-group">
      <label>Email Address</label>
      <input type="email" id="femail" placeholder="you@email.com" autocomplete="email"/>
      <div class="ferr" id="eEmail">Please enter a valid email address</div>
    </div>
    <div class="row2">
      <div class="form-group">
        <label>City</label>
        <input type="text" id="fcity" placeholder="Orai"/>
      </div>
      <div class="form-group">
        <label>PAN (optional)</label>
        <input type="text" id="fpan" placeholder="ABCDE1234F" maxlength="10"/>
      </div>
    </div>
    <button class="btn btn-primary" onclick="step1()">
      Continue
      <svg width="15" height="15" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </button>
    <div class="trust">
      <div class="trust-item">üîí 256-bit SSL</div>
      <div class="trust-item">‚úÖ RBI Approved</div>
      <div class="trust-item">üõ°Ô∏è Worldline Secured</div>
    </div>
  </div>

  <!-- STEP 2 -->
  <div class="screen" id="s2">
    <div class="card-eyebrow">Step 2 of 3</div>
    <div class="card-title">Seva details</div>
    <div class="card-sub">Choose how much and how often you'd like to offer.</div>
    <div class="form-group">
      <label>Seva Amount (‚Çπ)</label>
      <div class="amount-presets">
        <button class="preset-btn" onclick="setPreset(this,108)">‚Çπ108</button>
        <button class="preset-btn" onclick="setPreset(this,251)">‚Çπ251</button>
        <button class="preset-btn" onclick="setPreset(this,501)">‚Çπ501</button>
        <button class="preset-btn" onclick="setPreset(this,1001)">‚Çπ1001</button>
        <button class="preset-btn" onclick="setPreset(this,0)">Custom</button>
      </div>
      <input type="number" id="famount" placeholder="Enter amount in ‚Çπ" min="1"/>
      <div class="ferr" id="eAmt">Please enter a valid amount (minimum ‚Çπ1)</div>
    </div>
    <div class="form-group">
      <label>Frequency</label>
      <select id="ffreq">
        <option value="MNTH">Monthly</option>
        <option value="QURT">Quarterly</option>
        <option value="YEAR">Yearly</option>
        <option value="WEEK">Weekly</option>
        <option value="ADHO">As &amp; when presented</option>
      </select>
    </div>
    <div class="row2">
      <div class="form-group">
        <label>Start Date</label>
        <input type="date" id="fstart"/>
        <div class="ferr" id="eStart">Select a start date</div>
      </div>
      <div class="form-group">
        <label>End Date</label>
        <input type="date" id="fend"/>
        <div class="ferr" id="eEnd">End date must be after start</div>
      </div>
    </div>
    <div class="form-group">
      <label>Account Type</label>
      <select id="factype">
        <option value="Saving">Savings Account</option>
        <option value="Current">Current Account</option>
      </select>
    </div>
    <div class="info-box">
      ‚ÑπÔ∏è Your bank may debit ‚Çπ1‚Äì‚Çπ2 as an authentication charge during registration. This is standard and may be refunded within 2‚Äì3 working days.
    </div>
    <button class="btn btn-primary" onclick="step2()">
      Review &amp; Proceed
      <svg width="15" height="15" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </button>
    <button class="btn btn-ghost" onclick="goBack(1)">‚Üê Back</button>
  </div>

  <!-- STEP 3 -->
  <div class="screen" id="s3">
    <div class="card-eyebrow">Step 3 of 3</div>
    <div class="card-title">Confirm &amp; authorise</div>
    <div class="card-sub">Review your seva mandate then verify with your bank.</div>
    <div class="summary-box" id="summaryBox">
      <div class="summary-title">Seva Mandate Summary</div>
    </div>
    <div class="info-box">
      üîê A secure Worldline bank window will open. Verify using Net Banking, ATM/Debit Card, or Aadhaar OTP.
    </div>
    <button class="btn btn-primary" id="btnPay" onclick="launchCheckout()">
      <span id="btnTxt">Authorise with Bank</span>
      <svg id="btnArrow" width="15" height="15" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <div class="spin" id="btnSpin"></div>
    </button>
    <button class="btn btn-ghost" onclick="goBack(2)">‚Üê Back</button>
  </div>

  <!-- SUCCESS -->
  <div class="screen" id="sSuccess">
    <div class="result">
      <div class="result-icon r-success">
        <svg width="38" height="38" viewBox="0 0 38 38" fill="none"><circle cx="19" cy="19" r="18" fill="#2D6A3F" opacity=".15"/><path d="M11 19l6 6 10-10" stroke="#2D6A3F" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <h2>Hare Krishna! üôè</h2>
      <p>Your Nitya Seva has been registered. The Lord will receive your offering as scheduled.</p>
      <div class="mandate-pill" id="mandatePill">Mandate ID: ‚Äî</div>
      <div class="checklist">
        <div class="check-item">‚úÖ Bank account verified &amp; linked</div>
        <div class="check-item">‚úÖ Recurring seva scheduled</div>
        <div class="check-item">‚úÖ Confirmation SMS sent to your mobile</div>
      </div>
      <p style="font-size:12px;margin-top:8px">You may cancel this mandate anytime via your bank's net banking portal.</p>
    </div>
  </div>

  <!-- PENDING -->
  <div class="screen" id="sPending">
    <div class="result">
      <div class="result-icon r-pending">
        <svg width="38" height="38" viewBox="0 0 38 38" fill="none"><circle cx="19" cy="19" r="18" fill="#F59E0B" opacity=".15"/><path d="M19 10v9l5 5" stroke="#F59E0B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <h2>Registration Initiated</h2>
      <p>Your seva mandate has been submitted. Your bank will approve it within 24‚Äì48 hours.</p>
      <div class="mandate-pill" id="pendingPill" style="background:#FFF8E1;color:#B45309">Txn Ref: ‚Äî</div>
      <p style="font-size:12px;margin-top:12px">If you don't hear back in 48 hours, contact ISKCON Centre Orai with your transaction reference.</p>
    </div>
  </div>

  <!-- ERROR -->
  <div class="screen" id="sError">
    <div class="result">
      <div class="result-icon r-error">
        <svg width="38" height="38" viewBox="0 0 38 38" fill="none"><circle cx="19" cy="19" r="18" fill="#E74C3C" opacity=".12"/><path d="M1  background:#1C1608;
  padding:9px 16px;
  text-align:center;
  font-size:11px;
  font-weight:600;
  letter-spacing:2.5px;
  color:var(--gold);
  text-transform:uppercase;
}

/* ‚îÄ‚îÄ HERO SECTION ‚îÄ‚îÄ */
.hero{
  background:linear-gradient(160deg,#1C1608 0%,#3D2B0A 55%,#1C1608 100%);
  padding:48px 24px 56px;
  text-align:center;
  position:relative;
  overflow:hidden;
}
.hero::before{
  content:'';
  position:absolute;
  top:-60px;right:-60px;
  width:280px;height:280px;
  border-radius:50%;
  background:radial-gradient(circle,rgba(201,146,42,0.15),transparent 70%);
  pointer-events:none;
}
.hero::after{
  content:'';
  position:absolute;
  bottom:-80px;left:-80px;
  width:300px;height:300px;
  border-radius:50%;
  background:radial-gradient(circle,rgba(232,118,43,0.1),transparent 70%);
  pointer-events:none;
}

.emblem{
  width:72px;height:72px;
  margin:0 auto 16px;
  position:relative;z-index:1;
}
.emblem svg{width:100%;height:100%;}

.hero-tag{
  display:inline-block;
  font-size:10px;font-weight:700;
  letter-spacing:3px;text-transform:uppercase;
  color:var(--gold);
  border:1px solid rgba(201,146,42,0.4);
  padding:4px 14px;border-radius:100px;
  margin-bottom:16px;
  position:relative;z-index:1;
}
.hero h1{
  font-family:'Playfair Display',serif;
  font-size:clamp(36px,7vw,58px);
  font-weight:400;line-height:1.1;
  color:#FFFDF8;
  margin-bottom:14px;
  position:relative;z-index:1;
}
.hero h1 em{color:var(--saffron);font-style:italic;}
.hero p{
  font-size:14px;color:rgba(255,253,248,0.65);
  line-height:1.8;max-width:340px;
  margin:0 auto 28px;font-weight:300;
  position:relative;z-index:1;
}

/* Trust badges inside hero */
.hero-trust{
  display:flex;align-items:center;justify-content:center;
  gap:20px;flex-wrap:wrap;
  position:relative;z-index:1;
}
.ht-item{
  display:flex;align-items:center;gap:6px;
  font-size:11px;font-weight:600;
  color:rgba(255,253,248,0.5);
  letter-spacing:0.5px;
}

/* ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ */
.main{
  max-width:520px;
  margin:0 auto;
  padding:0 16px 80px;
}

/* ‚îÄ‚îÄ STEP INDICATOR ‚îÄ‚îÄ */
.steps{
  display:flex;align-items:center;
  padding:28px 0 24px;
  justify-content:center;
}
.step-item{display:flex;flex-direction:column;align-items:center;gap:6px;}
.step-dot{
  width:34px;height:34px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:12px;font-weight:700;
  background:var(--border);color:var(--muted);
  border:2px solid transparent;
  transition:all .3s;
}
.step-dot.active{
  background:var(--saffron);color:white;
  border-color:var(--saffron-d);
  box-shadow:0 0 0 4px rgba(232,118,43,0.2);
}
.step-dot.done{background:var(--green);color:white;border-color:var(--green);}
.step-lbl{
  font-size:9px;font-weight:700;
  letter-spacing:1px;text-transform:uppercase;
  color:var(--muted);transition:color .3s;
}
.step-lbl.active{color:var(--saffron);}
.step-line{
  width:50px;height:2px;
  background:var(--border);
  margin:0 4px 22px;
  border-radius:2px;
  transition:background .4s;
}
.step-line.done{background:var(--green);}

/* ‚îÄ‚îÄ CARD ‚îÄ‚îÄ */
.card{
  background:var(--white);
  border-radius:16px;
  border:1px solid var(--border);
  box-shadow:0 4px 32px rgba(28,22,8,0.08);
  padding:32px 28px;
  overflow:hidden;
}

.card-step{
  font-size:10px;font-weight:700;
  letter-spacing:2px;text-transform:uppercase;
  color:var(--saffron);margin-bottom:4px;
}
.card-title{
  font-family:'Playfair Display',serif;
  font-size:24px;font-weight:700;
  color:var(--ink);margin-bottom:4px;
}
.card-desc{
  font-size:13px;color:var(--muted);
  margin-bottom:24px;line-height:1.6;font-weight:400;
}

/* ‚îÄ‚îÄ FORM ‚îÄ‚îÄ */
.fg{margin-bottom:16px;}
.fg label{
  display:block;font-size:11px;font-weight:700;
  letter-spacing:0.8px;text-transform:uppercase;
  color:var(--muted);margin-bottom:6px;
}
.fg input,.fg select{
  width:100%;padding:13px 15px;
  border:1.5px solid var(--border);
  border-radius:10px;
  font-family:'Nunito',sans-serif;
  font-size:15px;color:var(--ink);
  background:var(--cream);
  outline:none;appearance:none;-webkit-appearance:none;
  transition:border-color .2s,box-shadow .2s,background .2s;
}
.fg input:focus,.fg select:focus{
  border-color:var(--saffron);
  background:var(--white);
  box-shadow:0 0 0 3px rgba(232,118,43,0.12);
}
.fg input.err{border-color:#c0392b;}
.ferr{font-size:11px;color:#c0392b;margin-top:4px;display:none;}
.ferr.show{display:block;}

/* Phone */
.ph{
  display:flex;border:1.5px solid var(--border);
  border-radius:10px;overflow:hidden;background:var(--cream);
  transition:border-color .2s,box-shadow .2s;
}
.ph:focus-within{
  border-color:var(--saffron);background:var(--white);
  box-shadow:0 0 0 3px rgba(232,118,43,0.12);
}
.ph.err{border-color:#c0392b;}
.ph-pre{
  display:flex;align-items:center;gap:5px;
  padding:13px 13px;background:var(--gold-l);
  border-right:1.5px solid var(--border);
  font-size:14px;color:var(--muted);font-weight:600;
  white-space:nowrap;flex-shrink:0;
}
.ph input{
  border:none!important;box-shadow:none!important;
  border-radius:0!important;background:transparent!important;
  flex:1;min-width:0;
}

/* Grid */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:12px;}

/* Amount presets */
.presets{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;}
.pbtn{
  padding:7px 14px;
  border:1.5px solid var(--border);border-radius:100px;
  font-family:'Nunito',sans-serif;font-size:13px;font-weight:600;
  color:var(--muted);background:var(--cream);
  cursor:pointer;transition:all .2s;
}
.pbtn:hover{border-color:var(--saffron);color:var(--saffron);}
.pbtn.on{background:var(--saffron);color:white;border-color:var(--saffron-d);}

/* Info note */
.note{
  background:var(--gold-l);border:1px solid #E8D5A0;
  border-radius:10px;padding:12px 14px;
  font-size:12.5px;color:#7A5C20;line-height:1.6;
  margin-bottom:20px;
}

/* Summary */
.summary{
  background:var(--cream);border:1.5px solid var(--border);
  border-radius:12px;padding:16px 18px;margin-bottom:20px;
}
.sum-title{
  font-size:10px;font-weight:700;letter-spacing:1.5px;
  text-transform:uppercase;color:var(--gold);margin-bottom:12px;
}
.sum-row{
  display:flex;justify-content:space-between;
  font-size:13px;padding:6px 0;
  border-bottom:1px solid var(--border);
}
.sum-row:last-child{border-bottom:none;}
.sum-row .k{color:var(--muted);font-weight:400;}
.sum-row .v{font-weight:600;text-align:right;max-width:55%;}

/* Buttons */
.btn{
  display:flex;align-items:center;justify-content:center;gap:8px;
  width:100%;padding:15px;border:none;border-radius:10px;
  font-family:'Nunito',sans-serif;font-size:15px;font-weight:700;
  cursor:pointer;transition:all .2s;letter-spacing:0.2px;
}
.btn-main{
  background:linear-gradient(135deg,var(--saffron) 0%,var(--saffron-d) 100%);
  color:white;
}
.btn-main:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(232,118,43,0.35);}
.btn-main:active{transform:translateY(0);}
.btn-main:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none;}
.btn-back{
  background:transparent;color:var(--muted);
  border:1.5px solid var(--border);margin-top:10px;font-size:13px;
}
.btn-back:hover{border-color:var(--muted);color:var(--ink);}

/* Spinner */
.spin{
  width:18px;height:18px;
  border:2px solid rgba(255,255,255,.35);
  border-top-color:white;border-radius:50%;
  animation:spinning .6s linear infinite;display:none;
}

/* ‚îÄ‚îÄ RESULT SCREENS ‚îÄ‚îÄ */
.result{text-align:center;padding:8px 0 12px;}
.r-icon{
  width:78px;height:78px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  margin:0 auto 22px;
  animation:popIn .4s cubic-bezier(.34,1.56,.64,1) both;
}
.ic-s{background:var(--green-l);}
.ic-p{background:#FFF8E1;}
.ic-e{background:#FDEDEB;}
.result h2{
  font-family:'Playfair Display',serif;
  font-size:28px;font-weight:700;margin-bottom:10px;
}
.result p{font-size:13px;color:var(--muted);line-height:1.7;}
.rpill{
  display:inline-block;font-size:12px;font-weight:700;
  letter-spacing:1px;padding:6px 18px;
  border-radius:100px;margin:14px 0;
}
.rpill-s{background:var(--saffron-l);color:var(--saffron-d);}
.rpill-p{background:#FFF8E1;color:#B45309;}
.checklist{
  background:var(--green-l);border-radius:10px;
  padding:14px 18px;margin:16px 0;text-align:left;
}
.ci{
  display:flex;align-items:center;gap:8px;
  font-size:13px;color:var(--green);padding:4px 0;font-weight:500;
}

/* ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ */
.screen{display:none;}
.screen.on{display:block;animation:fadeUp .35s ease both;}

/* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
.footer{
  text-align:center;margin-top:24px;
  font-size:11px;color:var(--muted);
}
.footer a{color:var(--saffron);text-decoration:none;}

/* ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ */
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes popIn{from{opacity:0;transform:scale(.5)}to{opacity:1;transform:scale(1)}}
@keyframes spinning{to{transform:rotate(360deg)}}

@media(max-width:480px){
  .card{padding:24px 18px;}
  .g2{grid-template-columns:1fr;}
  .step-line{width:30px;}
  .hero{padding:36px 20px 44px;}
}
</style>
</head>
<body>

<!-- Banner -->
<div class="banner">ü™∑ &nbsp; Hare Krishna ¬∑ Hare Krishna ¬∑ Krishna Krishna ¬∑ Hare Hare &nbsp; ü™∑</div>

<!-- Hero -->
<div class="hero">
  <div class="emblem">
    <svg viewBox="0 0 80 80" fill="none">
      <circle cx="40" cy="40" r="38" stroke="#C9922A" stroke-width="1.5" stroke-dasharray="4 3" opacity=".7"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#E8762B" opacity=".9"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#E8762B" opacity=".9" transform="rotate(45 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#E8762B" opacity=".9" transform="rotate(90 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#E8762B" opacity=".9" transform="rotate(135 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#C9922A" opacity=".65" transform="rotate(22.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#C9922A" opacity=".65" transform="rotate(67.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#C9922A" opacity=".65" transform="rotate(112.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="12" fill="#C9922A" opacity=".65" transform="rotate(157.5 40 40)"/>
      <circle cx="40" cy="40" r="11" fill="#2A1F06" stroke="#C9922A" stroke-width="1.5"/>
      <circle cx="40" cy="40" r="5.5" fill="#E8762B"/>
    </svg>
  </div>
  <div class="hero-tag">ISKCON Centre Orai</div>
  <h1>Nitya <em>Seva</em></h1>
  <p>Offer daily service to the Lord through automated giving ‚Äî sacred, secure &amp; uninterrupted.</p>
  <div class="hero-trust">
    <div class="ht-item">üîí 256-bit SSL</div>
    <div class="ht-item">‚úÖ RBI Approved</div>
    <div class="ht-item">üõ°Ô∏è Worldline Secured</div>
  </div>
</div>

<!-- Main -->
<div class="main">

  <!-- Steps -->
  <div class="steps" id="stepsBar">
    <div class="step-item">
      <div class="step-dot active" id="d1">1</div>
      <span class="step-lbl active" id="l1">You</span>
    </div>
    <div class="step-line" id="ln1"></div>
    <div class="step-item">
      <div class="step-dot" id="d2">2</div>
      <span class="step-lbl" id="l2">Seva</span>
    </div>
    <div class="step-line" id="ln2"></div>
    <div class="step-item">
      <div class="step-dot" id="d3">3</div>
      <span class="step-lbl" id="l3">Bank</span>
    </div>
    <div class="step-line" id="ln3"></div>
    <div class="step-item">
      <div class="step-dot" id="d4">4</div>
      <span class="step-lbl" id="l4">Done</span>
    </div>
  </div>

  <!-- Card -->
  <div class="card">

    <!-- ‚îÄ‚îÄ STEP 1 ‚îÄ‚îÄ -->
    <div class="screen on" id="s1">
      <div class="card-step">Step 1 of 3</div>
      <div class="card-title">Your details</div>
      <div class="card-desc">Tell us who you are so we can register your seva correctly.</div>

      <div class="fg">
        <label>Full Name</label>
        <input type="text" id="fn" placeholder="e.g. Rajesh Kumar" autocomplete="name"/>
        <div class="ferr" id="en">Please enter your full name</div>
      </div>

      <div class="fg">
        <label>Mobile Number</label>
        <div class="ph" id="pw">
          <div class="ph-pre">üáÆüá≥ +91</div>
          <input type="tel" id="fm" placeholder="9876543210" maxlength="10" inputmode="numeric"/>
        </div>
        <div class="ferr" id="em">Enter a valid 10-digit mobile number</div>
      </div>

      <div class="fg">
        <label>Email Address</label>
        <input type="email" id="fe" placeholder="you@email.com" autocomplete="email"/>
        <div class="ferr" id="ee">Please enter a valid email address</div>
      </div>

      <div class="g2">
        <div class="fg">
          <label>City</label>
          <input type="text" id="fc" placeholder="Orai"/>
        </div>
        <div class="fg">
          <label>PAN (optional)</label>
          <input type="text" id="fp" placeholder="ABCDE1234F" maxlength="10"/>
        </div>
      </div>

      <button class="btn btn-main" onclick="go1()">
        Continue &nbsp;‚Üí
      </button>
    </div>

    <!-- ‚îÄ‚îÄ STEP 2 ‚îÄ‚îÄ -->
    <div class="screen" id="s2">
      <div class="card-step">Step 2 of 3</div>
      <div class="card-title">Seva details</div>
      <div class="card-desc">Choose how much and how often you'd like to offer.</div>

      <div class="fg">
        <label>Seva Amount (‚Çπ)</label>
        <div class="presets">
          <button class="pbtn" onclick="setAmt(this,108)">‚Çπ108</button>
          <button class="pbtn" onclick="setAmt(this,251)">‚Çπ251</button>
          <button class="pbtn" onclick="setAmt(this,501)">‚Çπ501</button>
          <button class="pbtn" onclick="setAmt(this,1001)">‚Çπ1001</button>
          <button class="pbtn" onclick="setAmt(this,0)">Custom</button>
        </div>
        <input type="number" id="fa" placeholder="Or enter any amount in ‚Çπ" min="1"/>
        <div class="ferr" id="ea">Please enter a valid amount (minimum ‚Çπ1)</div>
      </div>

      <div class="fg">
        <label>Debit Frequency</label>
        <select id="ff">
          <option value="MNTH">Monthly</option>
          <option value="QURT">Quarterly</option>
          <option value="YEAR">Yearly</option>
          <option value="WEEK">Weekly</option>
          <option value="ADHO">As &amp; when presented</option>
        </select>
      </div>

      <div class="g2">
        <div class="fg">
          <label>Start Date</label>
          <input type="date" id="fsd"/>
          <div class="ferr" id="esd">Select a start date</div>
        </div>
        <div class="fg">
          <label>End Date</label>
          <input type="date" id="fed"/>
          <div class="ferr" id="eed">End date must be after start</div>
        </div>
      </div>

      <div class="fg">
        <label>Account Type</label>
        <select id="fat">
          <option value="Saving">Savings Account</option>
          <option value="Current">Current Account</option>
        </select>
      </div>

      <div class="note">
        ‚ÑπÔ∏è &nbsp;Your bank may debit ‚Çπ1‚Äì‚Çπ2 as an authentication charge during registration. This is standard and may be refunded within 2‚Äì3 working days.
      </div>

      <button class="btn btn-main" onclick="go2()">Review &amp; Proceed &nbsp;‚Üí</button>
      <button class="btn btn-back" onclick="back(1)">‚Üê Back</button>
    </div>

    <!-- ‚îÄ‚îÄ STEP 3 ‚îÄ‚îÄ -->
    <div class="screen" id="s3">
      <div class="card-step">Step 3 of 3</div>
      <div class="card-title">Confirm &amp; authorise</div>
      <div class="card-desc">Review your seva mandate then verify with your bank.</div>

      <div class="summary" id="sumBox"></div>

      <div class="note">
        üîê &nbsp;A secure Worldline bank window will open. Verify using Net Banking, ATM/Debit Card, or Aadhaar OTP.
      </div>

      <button class="btn btn-main" id="payBtn" onclick="launch()">
        <span id="payTxt">Authorise with Bank</span>
        <svg id="payArr" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <div class="spin" id="paySpin"></div>
      </button>
      <button class="btn btn-back" onclick="back(2)">‚Üê Back</button>
    </div>

    <!-- ‚îÄ‚îÄ SUCCESS ‚îÄ‚îÄ -->
    <div class="screen" id="sOK">
      <div class="result">
        <div class="r-icon ic-s">
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none"><circle cx="20" cy="20" r="19" fill="#2D6A3F" opacity=".15"/><path d="M11 20l7 7 11-11" stroke="#2D6A3F" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <h2>Hare Krishna! üôè</h2>
        <p>Your Nitya Seva has been registered successfully. The Lord will receive your offering as scheduled.</p>
        <div class="rpill rpill-s" id="midPill">Mandate ID: ‚Äî</div>
        <div class="checklist">
          <div class="ci">‚úÖ &nbsp;Bank account verified &amp; linked</div>
          <div class="ci">‚úÖ &nbsp;Recurring seva scheduled</div>
          <div class="ci">‚úÖ &nbsp;Confirmation SMS sent to your mobile</div>
        </div>
        <p style="font-size:12px;margin-top:4px">You may cancel this mandate anytime via your bank's net banking portal.</p>
        <button class="btn btn-main" style="margin-top:20px" onclick="reset()">Register Another Seva</button>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ PENDING ‚îÄ‚îÄ -->
    <div class="screen" id="sPend">
      <div class="result">
        <div class="r-icon ic-p">
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none"><circle cx="20" cy="20" r="19" fill="#F59E0B" opacity=".15"/><path d="M20 11v9l5 5" stroke="#F59E0B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <h2>Registration Initiated</h2>
        <p>Your seva mandate has been submitted. Your bank will approve it within 24‚Äì48 hours.</p>
        <div class="rpill rpill-p" id="pRef">Txn Ref: ‚Äî</div>
        <p style="font-size:12px;margin-top:10px">If you don't hear back in 48 hours, contact ISKCON Centre Orai with your reference number.</p>
        <button class="btn btn-main" style="margin-top:20px" onclick="reset()">Back to Home</button>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ ERROR ‚îÄ‚îÄ -->
    <div class="screen" id="sErr">
      <div class="result">
        <div class="r-icon ic-e">
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none"><circle cx="20" cy="20" r="19" fill="#E74C3C" opacity=".12"/><path d="M14 14l12 12M26 14L14 26" stroke="#E74C3C" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <h2>Registration Failed</h2>
        <p id="errTxt">The mandate could not be completed. Please try again.</p>
        <button class="btn btn-main" style="margin-top:22px" onclick="reset()">Try Again</button>
      </div>
    </div>

  </div><!-- /card -->

  <div class="footer">
    Powered by <a href="https://www.worldline.com" target="_blank">Worldline</a> &nbsp;¬∑&nbsp; Secured payments &nbsp;¬∑&nbsp; ISKCON Cen    .hero h1 { font-family:'Cormorant Garamond',serif; font-size:clamp(34px,6vw,52px); font-weight:400; line-height:1.1; color:var(--ink); margin-bottom:12px; }
    .hero h1 em { color:var(--saffron); font-style:italic; }
    .hero p { font-size:14px; color:var(--muted); line-height:1.7; max-width:360px; margin:0 auto; font-weight:300; }
    .ornament { display:flex; align-items:center; gap:12px; color:var(--gold); font-size:17px; margin:8px auto 28px; width:fit-content; }
    .ornament::before,.ornament::after { content:''; display:block; width:55px; height:1px; }
    .ornament::before { background:linear-gradient(to right,transparent,var(--gold)); }
    .ornament::after  { background:linear-gradient(to left,transparent,var(--gold)); }
    .steps { display:flex; align-items:center; gap:0; margin-bottom:24px; animation:fadeUp .7s .1s ease both; opacity:0; animation-fill-mode:both; }
    .step-item { display:flex; flex-direction:column; align-items:center; gap:5px; }
    .step-dot { width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px; font-weight:600; background:var(--border); color:var(--muted); transition:all .3s ease; border:2px solid transparent; }
    .step-dot.active { background:var(--saffron); color:white; border-color:var(--saffron-d); box-shadow:0 0 0 4px rgba(232,118,43,0.18); }
    .step-dot.done { background:var(--green); color:white; border-color:var(--green); }
    .step-label { font-size:9px; font-weight:600; letter-spacing:.8px; text-transform:uppercase; color:var(--muted); transition:color .3s; }
    .step-label.active { color:var(--saffron); }
    .step-conn { width:44px; height:1.5px; background:var(--border); margin:0 4px 20px; transition:background .4s; }
    .step-conn.done { background:var(--green); }
    .card { background:var(--white); border-radius:var(--r); box-shadow:var(--shadow); border:1px solid var(--border); padding:36px 30px; width:100%; max-width:480px; animation:fadeUp .7s .15s ease both; opacity:0; animation-fill-mode:both; }
    .card-eyebrow { font-size:10px; font-weight:600; letter-spacing:2px; text-transform:uppercase; color:var(--saffron); margin-bottom:5px; }
    .card-title { font-family:'Cormorant Garamond',serif; font-size:25px; font-weight:600; color:var(--ink); margin-bottom:4px; }
    .card-sub { font-size:13px; color:var(--muted); margin-bottom:26px; line-height:1.6; font-weight:300; }
    .form-group { margin-bottom:16px; }
    .form-group label { display:block; font-size:11px; font-weight:600; letter-spacing:.8px; text-transform:uppercase; color:var(--muted); margin-bottom:6px; }
    .form-group input,.form-group select {
      width:100%; padding:12px 14px; border:1.5px solid var(--border); border-radius:8px;
      font-family:'Jost',sans-serif; font-size:15px; color:var(--ink);
      background:var(--cream); transition:border-color .2s,box-shadow .2s,background .2s;
      outline:none; appearance:none; -webkit-appearance:none;
    }
    .form-group input:focus,.form-group select:focus { border-color:var(--saffron); background:var(--white); box-shadow:0 0 0 3px rgba(232,118,43,0.12); }
    .form-group input.err { border-color:#c0392b; }
    .ferr { font-size:11px; color:#c0392b; margin-top:4px; display:none; }
    .ferr.show { display:block; }
    .ph-wrap { display:flex; border:1.5px solid var(--border); border-radius:8px; overflow:hidden; background:var(--cream); transition:border-color .2s,box-shadow .2s; }
    .ph-wrap:focus-within { border-color:var(--saffron); background:var(--white); box-shadow:0 0 0 3px rgba(232,118,43,0.12); }
    .ph-wrap.err { border-color:#c0392b; }
    .ph-pfx { display:flex; align-items:center; gap:5px; padding:12px 13px; background:var(--gold-l); border-right:1.5px solid var(--border); font-size:14px; color:var(--muted); font-weight:500; white-space:nowrap; flex-shrink:0; }
    .ph-wrap input { border:none!important; box-shadow:none!important; border-radius:0!important; background:transparent!important; flex:1; }
    .amount-presets { display:flex; flex-wrap:wrap; gap:7px; margin-bottom:9px; }
    .preset-btn { padding:6px 13px; border:1.5px solid var(--border); border-radius:100px; font-family:'Jost',sans-serif; font-size:13px; font-weight:500; color:var(--muted); background:var(--cream); cursor:pointer; transition:all .2s; }
    .preset-btn:hover { border-color:var(--saffron); color:var(--saffron); }
    .preset-btn.sel { background:var(--saffron); color:white; border-color:var(--saffron-d); }
    .row2 { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .info-box { background:var(--gold-l); border:1px solid #E8D5A0; border-radius:8px; padding:11px 14px; font-size:12px; color:#7A5C20; line-height:1.6; margin-bottom:20px; display:flex; gap:8px; align-items:flex-start; }
    .summary-box { background:var(--cream); border:1.5px solid var(--border); border-radius:10px; padding:16px 18px; margin-bottom:20px; }
    .summary-title { font-size:10px; font-weight:600; letter-spacing:1.5px; text-transform:uppercase; color:var(--gold); margin-bottom:12px; }
    .sum-row { display:flex; justify-content:space-between; font-size:13px; padding:6px 0; border-bottom:1px solid var(--border); }
    .sum-row:last-child { border-bottom:none; }
    .sum-row .k { color:var(--muted); font-weight:300; }
    .sum-row .v { font-weight:500; text-align:right; max-width:60%; }
    .btn { display:flex; align-items:center; justify-content:center; gap:8px; width:100%; padding:14px 22px; border:none; border-radius:8px; font-family:'Jost',sans-serif; font-size:15px; font-weight:600; cursor:pointer; transition:all .2s ease; letter-spacing:.3px; }
    .btn-primary { background:linear-gradient(135deg,var(--saffron) 0%,var(--saffron-d) 100%); color:white; }
    .btn-primary:hover { transform:translateY(-2px); box-shadow:0 8px 24px rgba(232,118,43,0.35); }
    .btn-primary:active { transform:translateY(0); }
    .btn-primary:disabled { opacity:.6; cursor:not-allowed; transform:none; box-shadow:none; }
    .btn-ghost { background:transparent; color:var(--muted); border:1.5px solid var(--border); margin-top:10px; font-size:13px; }
    .btn-ghost:hover { border-color:var(--muted); color:var(--ink); }
    .spin { width:17px; height:17px; border:2px solid rgba(255,255,255,.4); border-top-color:white; border-radius:50%; animation:spinning .6s linear infinite; display:none; }
    .trust { display:flex; align-items:center; justify-content:center; gap:16px; flex-wrap:wrap; margin-top:18px; }
    .trust-item { display:flex; align-items:center; gap:5px; font-size:11px; color:var(--muted); font-weight:500; }
    .result { text-align:center; padding:8px 0 14px; }
    .result-icon { width:74px; height:74px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; animation:popIn .4s cubic-bezier(.34,1.56,.64,1) both; }
    .r-success { background:var(--green-l); }
    .r-pending { background:#FFF8E1; }
    .r-error   { background:#FDEDEB; }
    .result h2 { font-family:'Cormorant Garamond',serif; font-size:28px; font-weight:600; margin-bottom:10px; }
    .result p  { font-size:13px; color:var(--muted); line-height:1.7; font-weight:300; }
    .mandate-pill { display:inline-block; background:var(--saffron-l); color:var(--saffron-d); font-size:12px; font-weight:600; letter-spacing:1px; padding:6px 18px; border-radius:100px; margin:14px 0; }
    .checklist { background:var(--green-l); border-radius:10px; padding:14px 16px; margin:16px 0; text-align:left; }
    .check-item { display:flex; align-items:center; gap:9px; font-size:13px; color:var(--green); padding:4px 0; }
    .screen { display:none; }
    .screen.active { display:block; animation:fadeUp .35s ease both; }
    .footer { margin-top:24px; text-align:center; font-size:11px; color:var(--muted); animation:fadeUp .7s .3s ease both; opacity:0; animation-fill-mode:both; }
    .footer a { color:var(--saffron); text-decoration:none; }
    @keyframes fadeUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }
    @keyframes popIn  { from{opacity:0;transform:scale(.5)}       to{opacity:1;transform:scale(1)} }
    @keyframes spinning { to{transform:rotate(360deg)} }
    @media(max-width:480px){ .card{padding:24px 18px;} .row2{grid-template-columns:1fr;} .step-conn{width:26px;} }
  </style>
</head>
<body>

<div class="top-band">
  <span class="lotus">ü™∑</span>
  <span>Hare Krishna ¬∑ Hare Krishna ¬∑ Krishna Krishna ¬∑ Hare Hare</span>
  <span class="lotus">ü™∑</span>
</div>

<div class="hero">
  <div class="emblem">
    <svg viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="40" cy="40" r="38" stroke="#C9922A" stroke-width="1.5" stroke-dasharray="4 3"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85" transform="rotate(45 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85" transform="rotate(90 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#E8762B" opacity=".85" transform="rotate(135 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(22.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(67.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(112.5 40 40)"/>
      <ellipse cx="40" cy="22" rx="5" ry="11" fill="#C9922A" opacity=".7" transform="rotate(157.5 40 40)"/>
      <circle cx="40" cy="40" r="10" fill="#FBF3E0" stroke="#C9922A" stroke-width="1.5"/>
      <circle cx="40" cy="40" r="5" fill="#E8762B"/>
    </svg>
  </div>
  <div class="org-name">ISKCON Centre Orai</div>
  <h1>Nitya <em>Seva</em></h1>
  <p>Offer daily service to the Lord through automated giving ‚Äî sacred, secure &amp; uninterrupted.</p>
</div>

<div class="ornament">üå∏</div>

<div class="steps" id="stepIndicators">
  <div class="step-item"><div class="step-dot active" id="dot1">1</div><span class="step-label active" id="lbl1">You</span></div>
  <div class="step-conn" id="conn1"></div>
  <div class="step-item"><div class="step-dot" id="dot2">2</div><span class="step-label" id="lbl2">Seva</span></div>
  <div class="step-conn" id="conn2"></div>
  <div class="step-item"><div class="step-dot" id="dot3">3</div><span class="step-label" id="lbl3">Bank</span></div>
  <div class="step-conn" id="conn3"></div>
  <div class="step-item"><div class="step-dot" id="dot4">4</div><span class="step-label" id="lbl4">Done</span></div>
</div>

<div class="card">

  <!-- STEP 1 -->
  <div class="screen active" id="s1">
    <div class="card-eyebrow">Step 1 of 3</div>
    <div class="card-title">Your details</div>
    <div class="card-sub">Tell us who you are so we can register your seva correctly.</div>
    <div class="form-group">
      <label>Full Name</label>
      <input type="text" id="fname" placeholder="e.g. Rajesh Kumar" autocomplete="name"/>
      <div class="ferr" id="eName">Please enter your full name</div>
    </div>
    <div class="form-group">
      <label>Mobile Number</label>
      <div class="ph-wrap" id="phWrap">
        <div class="ph-pfx">üáÆüá≥ +91</div>
        <input type="tel" id="fmobile" placeholder="9876543210" maxlength="10" inputmode="numeric"/>
      </div>
      <div class="ferr" id="eMobile">Enter a valid 10-digit mobile number</div>
    </div>
    <div class="form-group">
      <label>Email Address</label>
      <input type="email" id="femail" placeholder="you@email.com" autocomplete="email"/>
      <div class="ferr" id="eEmail">Please enter a valid email address</div>
    </div>
    <div class="row2">
      <div class="form-group">
        <label>City</label>
        <input type="text" id="fcity" placeholder="Orai"/>
      </div>
      <div class="form-group">
        <label>PAN (optional)</label>
        <input type="text" id="fpan" placeholder="ABCDE1234F" maxlength="10"/>
      </div>
    </div>
    <button class="btn btn-primary" onclick="step1()">
      Continue
      <svg width="15" height="15" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </button>
    <div class="trust">
      <div class="trust-item">üîí 256-bit SSL</div>
      <div class="trust-item">‚úÖ RBI Approved</div>
      <div class="trust-item">üõ°Ô∏è Worldline Secured</div>
    </div>
  </div>

  <!-- STEP 2 -->
  <div class="screen" id="s2">
    <div class="card-eyebrow">Step 2 of 3</div>
    <div class="card-title">Seva details</div>
    <div class="card-sub">Choose how much and how often you'd like to offer.</div>
    <div class="form-group">
      <label>Seva Amount (‚Çπ)</label>
      <div class="amount-presets">
        <button class="preset-btn" onclick="setPreset(this,108)">‚Çπ108</button>
        <button class="preset-btn" onclick="setPreset(this,251)">‚Çπ251</button>
        <button class="preset-btn" onclick="setPreset(this,501)">‚Çπ501</button>
        <button class="preset-btn" onclick="setPreset(this,1001)">‚Çπ1001</button>
        <button class="preset-btn" onclick="setPreset(this,0)">Custom</button>
      </div>
      <input type="number" id="famount" placeholder="Enter amount in ‚Çπ" min="1"/>
      <div class="ferr" id="eAmt">Please enter a valid amount (minimum ‚Çπ1)</div>
    </div>
    <div class="form-group">
      <label>Frequency</label>
      <select id="ffreq">
        <option value="MNTH">Monthly</option>
        <option value="QURT">Quarterly</option>
        <option value="YEAR">Yearly</option>
        <option value="WEEK">Weekly</option>
        <option value="ADHO">As &amp; when presented</option>
      </select>
    </div>
    <div class="row2">
      <div class="form-group">
        <label>Start Date</label>
        <input type="date" id="fstart"/>
        <div class="ferr" id="eStart">Select a start date</div>
      </div>
      <div class="form-group">
        <label>End Date</label>
        <input type="date" id="fend"/>
        <div class="ferr" id="eEnd">End date must be after start</div>
      </div>
    </div>
    <div class="form-group">
      <label>Account Type</label>
      <select id="factype">
        <option value="Saving">Savings Account</option>
        <option value="Current">Current Account</option>
      </select>
    </div>
    <div class="info-box">
      ‚ÑπÔ∏è Your bank may debit ‚Çπ1‚Äì‚Çπ2 as an authentication charge during registration. This is standard and may be refunded within 2‚Äì3 working days.
    </div>
    <button class="btn btn-primary" onclick="step2()">
      Review &amp; Proceed
      <svg width="15" height="15" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </button>
    <button class="btn btn-ghost" onclick="goBack(1)">‚Üê Back</button>
  </div>

  <!-- STEP 3 -->
  <div class="screen" id="s3">
    <div class="card-eyebrow">Step 3 of 3</div>
    <div class="card-title">Confirm &amp; authorise</div>
    <div class="card-sub">Review your seva mandate then verify with your bank.</div>
    <div class="summary-box" id="summaryBox">
      <div class="summary-title">Seva Mandate Summary</div>
    </div>
    <div class="info-box">
      üîê A secure Worldline bank window will open. Verify using Net Banking, ATM/Debit Card, or Aadhaar OTP.
    </div>
    <button class="btn btn-primary" id="btnPay" onclick="launchCheckout()">
      <span id="btnTxt">Authorise with Bank</span>
      <svg id="btnArrow" width="15" height="15" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <div class="spin" id="btnSpin"></div>
    </button>
    <button class="btn btn-ghost" onclick="goBack(2)">‚Üê Back</button>
  </div>

  <!-- SUCCESS -->
  <div class="screen" id="sSuccess">
    <div class="result">
      <div class="result-icon r-success">
        <svg width="38" height="38" viewBox="0 0 38 38" fill="none"><circle cx="19" cy="19" r="18" fill="#2D6A3F" opacity=".15"/><path d="M11 19l6 6 10-10" stroke="#2D6A3F" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <h2>Hare Krishna! üôè</h2>
      <p>Your Nitya Seva has been registered. The Lord will receive your offering as scheduled.</p>
      <div class="mandate-pill" id="mandatePill">Mandate ID: ‚Äî</div>
      <div class="checklist">
        <div class="check-item">‚úÖ Bank account verified &amp; linked</div>
        <div class="check-item">‚úÖ Recurring seva scheduled</div>
        <div class="check-item">‚úÖ Confirmation SMS sent to your mobile</div>
      </div>
      <p style="font-size:12px;margin-top:8px">You may cancel this mandate anytime via your bank's net banking portal.</p>
    </div>
  </div>

  <!-- PENDING -->
  <div class="screen" id="sPending">
    <div class="result">
      <div class="result-icon r-pending">
        <svg width="38" height="38" viewBox="0 0 38 38" fill="none"><circle cx="19" cy="19" r="18" fill="#F59E0B" opacity=".15"/><path d="M19 10v9l5 5" stroke="#F59E0B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <h2>Registration Initiated</h2>
      <p>Your seva mandate has been submitted. Your bank will approve it within 24‚Äì48 hours.</p>
      <div class="mandate-pill" id="pendingPill" style="background:#FFF8E1;color:#B45309">Txn Ref: ‚Äî</div>
      <p style="font-size:12px;margin-top:12px">If you don't hear back in 48 hours, contact ISKCON Centre Orai with your transaction reference.</p>
    </div>
  </div>

  <!-- ERROR -->
  <div class="screen" id="sError">
    <div class="result">
      <div class="result-icon r-error">
        <svg width="38" height="38" viewBox="0 0 38 38" fill="none"><circle cx="19" cy="19" r="18" fill="#E74C3C" opacity=".12"/><path d="M13 13l12 12M25 13L13 25" stroke="#E74C3C" stroke-width="2" stroke-linecap="round"/></svg>
      </div>
      <h2>Registration Failed</h2>
      <p id="errMsg">The mandate could not be completed. Please try again.</p>
      <div style="margin-top:22px"><button class="btn btn-primary" onclick="resetAll()">Try Again</button></div>
    </div>
  </div>

</div>

<div class="footer">
  Powered by <a href="https://www.worldline.com" target="_blank">Worldline</a> &nbsp;¬∑&nbsp; ISKCON Centre Orai ¬© 2025
</div>

<script>
// ‚îÄ‚îÄ CREDENTIALS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const MID  = 'L1042784';
const SALT = '9513499579TRJAQP';

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let fd = {};

// ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const showScreen = id => {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo({top: 0, behavior: 'smooth'});
};

const fmtDate = d => { const [y,m,day] = d.split('-'); return `${day}-${m}-${y}`; };
const makeTid = () => Date.now().toString();

function setDot(step) {
  for (let i = 1; i <= 4; i++) {
    const d = document.getElementById('dot'+i);
    const l = document.getElementById('lbl'+i);
    d.classList.remove('active','done');
    l.classList.remove('active');
    if (i < step)      { d.classList.add('done'); d.innerHTML = '‚úì'; }
    else if (i===step) { d.classList.add('active'); d.innerHTML = i; l.classList.add('active'); }
    else               { d.innerHTML = i; }
  }
  for (let i = 1; i <= 3; i++)
    document.getElementById('conn'+i).classList.toggle('done', i < step);
}

function fe(fid, eid, on) {
  document.getElementById(fid)?.classList.toggle('err', on);
  document.getElementById(eid)?.classList.toggle('show', on);
}
function phErr(on) {
  document.getElementById('phWrap').classList.toggle('err', on);
  document.getElementById('eMobile').classList.toggle('show', on);
}

// ‚îÄ‚îÄ AMOUNT PRESETS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setPreset(btn, val) {
  document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('sel'));
  btn.classList.add('sel');
  const inp = document.getElementById('famount');
  if (val === 0) { inp.value = ''; inp.focus(); }
  else inp.value = val;
}

// ‚îÄ‚îÄ STEP 1 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function step1() {
  let ok = true;
  const name   = document.getElementById('fname').value.trim();
  const mobile = document.getElementById('fmobile').value.trim();
  const email  = document.getElementById('femail').value.trim();

  if (!name)                     { fe('fname','eName',true);   ok=false; } else fe('fname','eName',false);
  if (!/^\d{10}$/.test(mobile)) { phErr(true);                ok=false; } else phErr(false);
  if (!/.+@.+\..+/.test(email)) { fe('femail','eEmail',true); ok=false; } else fe('femail','eEmail',false);
  if (!ok) return;

  fd = { name, mobile, email,
    city: document.getElementById('fcity').value.trim(),
    pan:  document.getElementById('fpan').value.toUpperCase()
  };

  // Default dates
  const today = new Date();
  document.getElementById('fstart').value = today.toISOString().split('T')[0];
  const end = new Date(today); end.setFullYear(end.getFullYear()+10);
  document.getElementById('fend').value = end.toISOString().split('T')[0];

  setDot(2); showScreen('s2');
}

// ‚îÄ‚îÄ STEP 2 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function step2() {
  let ok = true;
  const amount = document.getElementById('famount').value.trim();
  const start  = document.getElementById('fstart').value;
  const end    = document.getElementById('fend').value;

  if (!amount || isNaN(amount) || parseFloat(amount) < 1) { fe('famount','eAmt',true);  ok=false; } else fe('famount','eAmt',false);
  if (!start)                                              { fe('fstart','eStart',true); ok=false; } else fe('fstart','eStart',false);
  if (!end || end <= start)                                { fe('fend','eEnd',true);     ok=false; } else fe('fend','eEnd',false);
  if (!ok) return;

  fd.amount  = parseFloat(amount).toFixed(2);
  fd.freq    = document.getElementById('ffreq').value;
  fd.start   = fmtDate(start);
  fd.end     = fmtDate(end);
  fd.actype  = document.getElementById('factype').value;
  fd.amtType = 'M';

  const freqMap = {DAIL:'Daily',WEEK:'Weekly',MNTH:'Monthly',QURT:'Quarterly',MIAN:'Semi-annually',YEAR:'Yearly',BIMN:'Bi-monthly',ADHO:'As & when presented'};
  const rows = [
    ['Devotee',     fd.name],
    ['Mobile',      '+91 ' + fd.mobile],
    ['Email',       fd.email],
    ['Seva Amount', '‚Çπ ' + parseFloat(fd.amount).toLocaleString('en-IN')],
    ['Frequency',   freqMap[fd.freq]],
    ['Start Date',  fd.start],
    ['End Date',    fd.end],
    ['Account',     fd.actype],
  ];

  document.getElementById('summaryBox').innerHTML =
    '<div class="summary-title">Seva Mandate Summary</div>' +
    rows.map(([k,v]) => `<div class="sum-row"><span class="k">${k}</span><span class="v">${v}</span></div>`).join('');

  setDot(3); showScreen('s3');
}

// ‚îÄ‚îÄ BACK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function goBack(to) { setDot(to); showScreen('s'+to); }

// ‚îÄ‚îÄ SHA-512 token (browser crypto) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Hash format per Worldline docs:
// merchantId|txnId|totalAmount|accountNo|consumerId|mobileNo|email|
// debitStart|debitEnd|maxAmount|amountType|frequency|cardNo|expM|expY|cvv|SALT
// NOTE: totalAmount = item amount (1), not the seva amount
async function makeToken(tid) {
  const cid     = ('cust_' + fd.mobile).slice(0, 20);
  const itemAmt = '1'; // authentication charge amount passed in items[]
  const str = [
    MID, tid, itemAmt, '',
    cid, fd.mobile, fd.email,
    fd.start, fd.end,
    fd.amount, fd.amtType, fd.freq,
    '', '', '', '',
    SALT
  ].join('|');
  const buf = await crypto.subtle.digest('SHA-512', new TextEncoder().encode(str));
  const hex = Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
  return { token: hex, consumerId: cid };
}

// ‚îÄ‚îÄ LAUNCH WORLDLINE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function launchCheckout() {
  const btn = document.getElementById('btnPay');
  const txt = document.getElementById('btnTxt');
  const arr = document.getElementById('btnArrow');
  const sp  = document.getElementById('btnSpin');

  btn.disabled = true;
  txt.textContent = 'Connecting to bank‚Ä¶';
  arr.style.display = 'none';
  sp.style.display  = 'block';

  const tid = makeTid();
  const { token, consumerId } = await makeToken(tid);

  $.pnCheckout({
    features: {
      enableAbortResponse:    true,
      enableExpressPay:       true,
      enableMerTxnDetails:    true,
      siDetailsAtMerchantEnd: true,
      enableSI:               true
    },
    consumerData: {
      deviceId:         'WEBSH2',
      token,
      returnUrl:        window.location.origin + '/response.html',
      responseHandler:  handleResponse,
      paymentMode:      'all',
      merchantLogoUrl:  'https://www.paynimo.com/CompanyDocs/company-logo-vertical.png',
      merchantId:       MID,
      currency:         'INR',
      consumerId,
      consumerMobileNo: fd.mobile,
      consumerEmailId:  fd.email,
      txnId:            tid,
      items:            [{ itemId:'first', amount:'1', comAmt:'0' }],
      accountType:      fd.actype,
      debitStartDate:   fd.start,
      debitEndDate:     fd.end,
      maxAmount:        fd.amount,
      amountType:       fd.amtType,
      frequency:        fd.freq,
      customStyle: {
        PRIMARY_COLOR_CODE:   '#E8762B',
        SECONDARY_COLOR_CODE: '#FFFFFF',
        BUTTON_COLOR_CODE_1:  '#C4581A',
        BUTTON_COLOR_CODE_2:  '#FFFFFF'
      }
    }
  });

  // Re-enable button after 5s in case user closes popup
  setTimeout(() => {
    btn.disabled = false;
    txt.textContent = 'Authorise with Bank';
    arr.style.display = 'block';
    sp.style.display  = 'none';
  }, 5000);
}

// ‚îÄ‚îÄ RESPONSE HANDLER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function handleResponse(res) {
  setDot(4);
  if (!res?.paymentMethod?.paymentTransaction) {
    document.getElementById('errMsg').textContent = 'No response from bank gateway. Please try again.';
    return showScreen('sError');
  }
  const txn  = res.paymentMethod.paymentTransaction;
  const code = txn.statusCode;

  if (code === '0300') {
    document.getElementById('mandatePill').textContent = 'Mandate ID: ' + (txn.mandate_reg_no || txn.identifier || '‚Äî');
    showScreen('sSuccess');
  } else if (code === '0398') {
    document.getElementById('pendingPill').textContent = 'Txn Ref: ' + (txn.identifier || '‚Äî');
    showScreen('sPending');
  } else {
    document.getElementById('errMsg').textContent = txn.errorMessage || txn.statusMessage || 'Registration failed. Please try again.';
    showScreen('sError');
  }
}

// ‚îÄ‚îÄ RESET ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function resetAll() {
  fd = {};
  ['fname','fmobile','femail','fcity','fpan','famount','fstart','fend']
    .forEach(id => { const el = document.getElementById(id); if(el) el.value = ''; });
  document.querySelectorAll('.ferr').forEach(e => e.classList.remove('show'));
  document.querySelectorAll('input,select').forEach(e => e.classList.remove('err'));
  document.getElementById('phWrap').classList.remove('err');
  document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('sel'));
  setDot(1); showScreen('s1');
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
setDot(1);
document.getElementById('fmobile').addEventListener('input', function() {
  this.value = this.value.replace(/\D/g,'').slice(0,10);
});
document.getElementById('fpan').addEventListener('input', function() {
  this.value = this.value.toUpperCase();
});
document.getElementById('famount').addEventListener('input', function() {
  document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('sel'));
});
</script>
</body>
</html>
